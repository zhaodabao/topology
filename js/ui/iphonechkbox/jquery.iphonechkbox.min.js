(function(){var a,b=Array.prototype.slice;a=(function(){function c(g,d){var e,f,h;this.elem=$(g);f=$.extend({},c.defaults,d);for(e in f){h=f[e];this[e]=h}this.elem.data(this.dataName,this);this.wrapCheckboxWithDivs();this.attachEvents();this.disableTextSelection();if(this.resizeHandle){this.optionallyResize("handle")}if(this.resizeContainer){this.optionallyResize("container")}this.initialPosition()}c.prototype.isDisabled=function(){return this.elem.is(":disabled")};c.prototype.wrapCheckboxWithDivs=function(){this.elem.wrap("<div class='"+this.containerClass+"' />");this.container=this.elem.parent();this.offLabel=$("<label class='"+this.labelOffClass+"'>\n  <span>"+this.uncheckedLabel+"</span>\n</label>").appendTo(this.container);this.offSpan=this.offLabel.children("span");this.onLabel=$("<label class='"+this.labelOnClass+"'>\n  <span>"+this.checkedLabel+"</span>\n</label>").appendTo(this.container);this.onSpan=this.onLabel.children("span");return this.handle=$("<div class='"+this.handleClass+"'>\n  <div class='"+this.handleRightClass+"'>\n    <div class='"+this.handleCenterClass+"' />\n  </div>\n</div>").appendTo(this.container)};c.prototype.disableTextSelection=function(){if($.browser.msie){return $([this.handle,this.offLabel,this.onLabel,this.container]).attr("unselectable","on")}};c.prototype._getDimension=function(d,e){if($.fn.actual!=null){return d.actual(e)}else{return d[e]()}};c.prototype._getEleCloneWidth=function(d){var f=d.clone().appendTo("body");var e=this._getDimension(f,"width");f.remove();return e};c.prototype.optionallyResize=function(g){var f,e,d;d=this._getEleCloneWidth(this.onLabel);e=this._getEleCloneWidth(this.offLabel);if(g==="container"){f=d>e?d:e;f+=this._getEleCloneWidth(this.handle)+this.handleMargin;return this.container.css({width:f})}else{f=d>e?d:e;return this.handle.css({width:f})}};c.prototype.onMouseDown=function(e){var d;e.preventDefault();if(this.isDisabled()){return}d=e.pageX||e.originalEvent.changedTouches[0].pageX;c.currentlyClicking=this.handle;c.dragStartPosition=d;return c.handleLeftOffset=parseInt(this.handle.css("left"),10)||0};c.prototype.onDragMove=function(f,d){var e,g;if(c.currentlyClicking!==this.handle){return}g=(d+c.handleLeftOffset-c.dragStartPosition)/this.rightSide;if(g<0){g=0}if(g>1){g=1}e=g*this.rightSide;this.handle.css({left:e});this.onLabel.css({width:e+this.handleRadius});this.offSpan.css({marginRight:-e});return this.onSpan.css({marginLeft:-(1-g)*this.rightSide})};c.prototype.onDragEnd=function(e,d){var f;if(c.currentlyClicking!==this.handle){return}if(this.isDisabled()){return}if(c.dragging){f=(d-c.dragStartPosition)/this.rightSide;this.elem.prop("checked",f>=0.5)}else{this.elem.prop("checked",!this.elem.prop("checked"))}c.currentlyClicking=null;c.dragging=null;return this.didChange()};c.prototype.refresh=function(){return this.didChange()};c.prototype.didChange=function(){var d;if(typeof this.onChange==="function"){this.onChange(this.elem,this.elem.prop("checked"))}if(this.isDisabled()){this.container.addClass(this.disabledClass);return false}else{this.container.removeClass(this.disabledClass)}d=this.elem.prop("checked")?this.rightSide:0;this.handle.animate({left:d},this.duration);this.onLabel.animate({width:d+this.handleRadius},this.duration);this.offSpan.animate({marginRight:-d},this.duration);return this.onSpan.animate({marginLeft:d-this.rightSide},this.duration)};c.prototype.attachEvents=function(){var f,e,d;d=this;f=function(g){return d.onGlobalMove.apply(d,arguments)};e=function(g){d.onGlobalUp.apply(d,arguments);$(document).unbind("mousemove touchmove",f);return $(document).unbind("mouseup touchend",e)};this.elem.change(function(){return d.refresh()});return this.container.bind("mousedown touchstart",function(g){d.onMouseDown.apply(d,arguments);$(document).bind("mousemove touchmove",f);return $(document).bind("mouseup touchend",e)})};c.prototype.initialPosition=function(){var d,e;d=this._getEleCloneWidth(this.container);this.offLabel.css({width:d-this.containerRadius});e=this.containerRadius+1;if($.browser.msie&&Number($.browser.version.split(".")[0])<7){e-=3}this.rightSide=d-this._getEleCloneWidth(this.handle)-e;if(this.elem.is(":checked")){this.handle.css({left:this.rightSide});this.onLabel.css({width:this.rightSide+this.handleRadius});this.offSpan.css({marginRight:-this.rightSide})}else{this.onLabel.css({width:0});this.onSpan.css({marginLeft:-this.rightSide})}if(this.isDisabled()){return this.container.addClass(this.disabledClass)}};c.prototype.onGlobalMove=function(e){var d;if(!(!this.isDisabled()&&c.currentlyClicking)){return}e.preventDefault();d=e.pageX||e.originalEvent.changedTouches[0].pageX;if(!c.dragging&&(Math.abs(c.dragStartPosition-d)>this.dragThreshold)){c.dragging=true}return this.onDragMove(e,d)};c.prototype.onGlobalUp=function(e){var d;if(!c.currentlyClicking){return}e.preventDefault();d=e.pageX||e.originalEvent.changedTouches[0].pageX;this.onDragEnd(e,d);return false};c.defaults={duration:200,checkedLabel:"开",uncheckedLabel:"关",resizeHandle:true,resizeContainer:true,disabledClass:"iPhoneCheckDisabled",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleCenterClass:"iPhoneCheckHandleCenter",handleRightClass:"iPhoneCheckHandleRight",dragThreshold:5,handleMargin:10,handleRadius:4,containerRadius:5,dataName:"iphoneStyle",onChange:function(){}};return c})();$.iphoneStyle=this.iOSCheckbox=a;$.fn.iphoneStyle=function(){var l,k,d,m,c,h,i,n,j,g,f,e;l=1<=arguments.length?b.call(arguments,0):[];d=(j=(g=l[0])!=null?g.dataName:void 0)!=null?j:a.defaults.dataName;f=this.filter(":checkbox");for(i=0,n=f.length;i<n;i++){k=f[i];m=$(k).data(d);if(m!=null){c=l[0],h=2<=l.length?b.call(l,1):[];if((e=m[c])!=null){e.apply(m,h)}}else{new a(k,l[0])}}return this};$.fn.iOSCheckbox=function(c){var d;if(c==null){c={}}d=$.extend({},c,{resizeHandle:false,disabledClass:"iOSCheckDisabled",containerClass:"iOSCheckContainer",labelOnClass:"iOSCheckLabelOn",labelOffClass:"iOSCheckLabelOff",handleClass:"iOSCheckHandle",handleCenterClass:"iOSCheckHandleCenter",handleRightClass:"iOSCheckHandleRight",dataName:"iOSCheckbox"});return this.iphoneStyle(d)}}).call(this);